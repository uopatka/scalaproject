@(bookEntries: List[models.BookEntry],
books: List[models.Book],
selectedBook: Option[(models.BookEntry, models.Book)] = None,
username: Option[String] = None)(implicit request: play.api.mvc.RequestHeader)

@import viewmodels.CoverResolver

@main("Strona główna") {
<!-- kolory strony do zmiany w przyszłości -->
<style>
    .green-background-panel {
        background-color: #4A9782;
        padding: 20px;
        border-radius: 4px;
        min-height: 450px;
        color: white;
    }

    .book-button {
    display: block;
    width: 100%;
    padding: 14px 16px;
    border-radius: 6px;
    color: white;
    text-decoration: none;
    transition: background-color 0.2s ease;
    margin: 10px
    }

    .book-button:hover {
    background-color: rgba(255, 255, 255, 0.15);
    color: white;
    }

    .book-button.active {
        background-color: rgba(255, 255, 255, 0.25);
    }

    .book-author {
        font-size: 0.85rem;
        opacity: 0.85;
    }

</style>

<div class="container mt-4">
    <div class="d-flex justify-content-end mb-3">
        @username.map { name =>
        <div class="user-info">
            Witaj, <strong>@name</strong>!
            <a href="@routes.AuthController.logout()" class="btn btn-outline-danger btn-sm ms-2">Wyloguj się</a>
        </div>
        }.getOrElse {
        <a href="@routes.AuthController.loginPage()" class="btn btn-outline-primary btn-sm">Zaloguj się</a>
        }
    </div>

    <div class="text-center mb-5">
        <h1 class="display-3">Moja biblioteczka</h1>
        <div class="mt-3">
            <a href="@routes.HomeController.addBook()" class="btn btn-light btn-lg shadow-sm">
                <i class="bi bi-plus-lg"></i> Dodaj książkę
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-md-7">
            <div class="green-background-panel">
                @if(bookEntries.isEmpty) {
                    <p>Brak książek.</p>
                } else {
                    @for(entry <- bookEntries) { <!-- trzeba to wycentrowac lol -->
                        @defining(books.find(_.isbn == entry.isbn)) { bookOpt =>
                            <a href="@routes.HomeController.showBook(entry.isbn)"
                               class="book-button
                               @if(selectedBook.exists(_._1.isbn == entry.isbn)) { active }">
                                @bookOpt.map { book =>

                                    <strong>@book.title</strong><br>
                                    <span class="book-author">@book.author</span>
                                }.getOrElse {
                                    <em>Nieznana książka (ISBN: @entry.isbn)</em>
                                }
                            </a>
                        }
                    }
                }
            </div>
        </div>

        <div class="col-md-5">
            <div class="green-background-panel">
                @selectedBook.map { case (entry, book) =>
                <div class="mb-3">
                    <a href="@routes.HomeController.deleteBook(entry.id)" class="btn btn-light btn-lg shadow-sm">
                        Usuń książkę
                    </a>
                    <a href="@routes.HomeController.editBookEntry(entry.id)" class="btn btn-light btn-lg shadow-sm">
                        Edytuj książkę
                    </a>
                </div>


                <div class="text-center mb-3">
                    <img
                            src= "@CoverResolver.resolve(entry, book)"
                            alt="Okładka książki"
                            class="img-fluid rounded shadow"
                            style="max-height: 300px;"
                    >
                </div>




                <h3>@book.title</h3>
                    <p><strong>Autor:</strong> @book.author</p>
                    <p><strong>ISBN:</strong> @book.isbn</p>
                    <p><strong>Rok publikacji:</strong> @book.publishYear</p>
                    <p><strong>Przeczytane strony:</strong> @entry.pagesRead</p>
                    <p><strong>Liczba stron:</strong> @book.pages</p>
                    <p><strong>Status:</strong> @entry.status</p>
                }.getOrElse {
                    <p>Szczegóły książki będą wyświetlone tutaj po kliknięciu.</p>
                }
            </div>
        </div>

    </div> </div>
}